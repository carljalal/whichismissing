<html>
<body>
<script>



let listArray = [];
let targetAnswer = "";
let startTime = 0.0;
let lastTime = 0.0;
let currentTime = 0.0;
let numCorrect = 0;

answerTextarea = document.createElement("textarea");
questionDiv = document.createElement("div");
feedbackDiv = document.createElement("div");
scoreDiv = document.createElement("div");
initButton = document.createElement("button");
listTextarea = document.createElement("textarea");

document.body.append(answerTextarea);
document.body.append(questionDiv);
document.body.append(feedbackDiv);
document.body.append(scoreDiv);
document.body.append(initButton);
document.body.append(document.createElement("br"));
document.body.append(listTextarea);

initButton.innerHTML = "init list!"
listTextarea.rows = 10;

initList = () => {
    let str = listTextarea.value;
    str = str.replace("\r\g","");
    listArray = str.split("\n");
    listTextarea.value = "";
    nextQuestion();
    lastTime = performance.now();
    startTime = lastTime;
    numCorrect = 0;
}

nextQuestion = () => {
    let mostlyfullList = [];
    let leftoverList = [...listArray];
    while (leftoverList.length > 1){
        let r = Math.floor(Math.random() * leftoverList.length);
        mostlyfullList.push(leftoverList[r]);
        leftoverList.splice(r,1);
    }
    questionDiv.innerHTML = mostlyfullList.join("<br>");
    targetAnswer = leftoverList[0];
}



answerTextarea.addEventListener("keyup", (event)=> {
    if(event.key =="Enter") answerTextarea.value = "";
})

answerTextarea.addEventListener("keydown",(event)=> {
    if(listArray.length < 1) questionDiv.textContent = "no list has been initalized yet!"
    if(event.key == "Enter") {
        if(targetAnswer != answerTextarea.value) feedbackDiv.textContent = "error";
        if(targetAnswer == "" || targetAnswer == answerTextarea.value) {
            feedbackDiv.textContent = "correct!";
            numCorrect++;
            currentTime = performance.now();
            scoreDiv.innerHTML = "<br>num correct: " + numCorrect;
            scoreDiv.innerHTML += "<br>last performance: " + ((currentTime-lastTime)/1000.0).toFixed(2) + "s";
            scoreDiv.innerHTML += "<br>average performance: " + ((currentTime-startTime)/(numCorrect*1000.0)).toFixed(2) + "s";
            lastTime = currentTime;
            nextQuestion();
        }
        
    }
    
});
initButton.onclick = () => {initList();}







</script>
</body>
</html>